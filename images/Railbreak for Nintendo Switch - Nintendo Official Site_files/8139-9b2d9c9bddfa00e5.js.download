"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8139],{58139:function(e,t,a){a.d(t,{Z:function(){return q}});var r=a(95235),s=a(82269),i=a(2784),l=a(64897),n=a(32899),o=a(97224),c=a(46420),u=a(7771),p=a(51505),m=a(89937),d=a(3005),h=a(67335),f=a(1505),g=a(84510),b=a(15824),j=a(66906),y=a(9873),x=a(67371),P=a(80963),v=a(32542),O=a(86743),S=a(91042),k=(a(71105),a(72354)),N=a(61748),w=(a(63288),a(87136)),M=a(90643),F=a(11034),C=a(52322);const D=["attribute","items","cmsItems","refine","cmsRefine"];function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const L=e=>{const{attribute:t,items:a,cmsItems:l,refine:n,cmsRefine:o}=e,c=(0,s.Z)(e,D),u=(0,i.useMemo)((()=>(0,M.iJ)(t,a,l)),[t,a,l]),p=(0,i.useCallback)((e=>{let{value:t,cmsValue:a}=e;t&&n(t),a&&o(a)}),[n,o]);return(0,C.jsx)(S.vT,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({refine:p,attribute:t,items:u},c))};L.defaultProps={autoExpand:!0,collapsible:!0,startCollapsed:!0,displayOptions:{},operator:"and"};var H=L,Z=a(32075);var E=(e,t,a)=>{if(!e?.length)return t||[];if(!t?.length)return e||[];const{interval:r=10,isPromoInFirstPosition:s}=a||{};let i=0;return t.reduce(((t,a,l)=>{if(0===l&&s){const t=e?.[i];return t?(i++,[t,a]):[a]}if(l>0&&l%r===0){const r=e?.[i];return r?(i++,[...t,r,a]):[...t,a]}return[...t,a]}),[])},$=a(57912),B=a(23682),R=a(42924),z=a(62898);const _=["title","attribute"],T=["objectID"],A=["objectID"];function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const J="scroll-top-of-grid";function U(e){let{preview:t,page:a,pageIcon:r,showRating:D,filterSections:I,breadcrumbLinks:L,analytics:G,cachePrefix:U,enableHorizontalTiles:q,fullBleedHero:K,cmsProductPageSize:X,seeAllCtaLabel:Q,disableDefaultMarketingPageHeading:W,enableStickyCollectionNav:Y}=e;const{pageHeader:ee,ctaCollection:te,merchandisedGrid:ae,isPromoInFirstPosition:re,marketingPage:se,productsCategoryUid:ie}=a,{state:{isSearching:le,availableRefinements:ne,rawSearchHits:oe,hasMore:ce,sortBy:ue,sortByOptions:pe,activeIndexName:me,activeFilters:de,totalHits:he=0},actions:{loadMore:fe,refine:ge,applySortBy:be,applyCustomParams:je,clearFilters:ye,removeFilter:xe}}=(0,c.Rx)(),Pe=(0,x.O_)(),ve=se?R[se?.templateName??"plmpStandard"]:null,Oe=W?d.H:d.H.NewLevel,Se=(0,l.Z)(),ke=(0,n.i1)(),{trackLoadMoreProducts:Ne}=(0,u.u)(),{text:we}=ke,{asPath:Me}=Se,Fe=(0,n.SS)("wdev-1631-horizontal-tiles"),Ce=Fe?.variant?.payload?.value,De=q&&"horizontal"===Ce,{waitForElementRef:Ie}=(0,x.r)(),Le=G?.eventPrefix&&`${G?.eventPrefix} PLP: Product Clicked`,He=(0,P.Z)(P.o.DESKTOP),Ze=(0,i.useRef)();Ze.current=He;const Ee=(0,n.uX)(Me),$e=parseInt(Ee.show)||0,{isFilterModalOpen:Be,selectedSortByOption:Re,toggleModalFiltersMenu:ze,handleSortByChange:_e}=(0,c.sI)({sortBy:ue,sortByOptions:pe,applySortBy:be,analytics:{pageName:G.pageName}}),Te=(0,i.useMemo)((()=>(ae||[]).flat()),[ae]),Ae=(0,i.useMemo)((()=>Re?.value===u.f.DEFAULT?Te.filter((e=>{let{sku:t}=e;return Boolean(t)})):[]),[Te,Re]),Ge=(0,i.useMemo)((()=>{if(ie){const e=Te.filter((e=>{let{sku:t}=e;return!t}));return E(e,Ae,{isPromoInFirstPosition:re})}return Te}),[Ae,Te,re,ie]),Ve=(0,i.useMemo)((()=>I.map((e=>e.attribute===u.z.ESRB_RATING&&w.bh[Se.locale]||e))),[Se.locale,I]),Je=(0,i.useMemo)((()=>Ve.map((e=>{let{attribute:t}=e;return t}))),[Ve]),{appliedFilters:Ue,filteredProducts:qe,filteredState:Ke,refine:Xe,refineByQuery:Qe,clearFilters:We}=(0,x.x3)(Ae,Je,{operator:x.fP.AND,queryToInitializeFilters:(0,n.uX)()}),Ye=(0,i.useCallback)((e=>(je({show:0}),e)),[je]),et=(0,i.useCallback)((function(){return Ye(ge)(...arguments)}),[Ye,ge]),tt=(0,i.useCallback)((e=>{Ye((e=>{let{value:t,cmsValue:a}=e;t&&xe(t),a&&Xe(a)}))(e)}),[xe,Xe,Ye]),at=(0,i.useCallback)((()=>{Ye((()=>{ye(),We()}))()}),[ye,We,Ye]),rt=(0,i.useCallback)((function(){Ye(_e)(...arguments)}),[_e,Ye]),st=(0,i.useCallback)((()=>{const{pageName:e}=G||{};e&&Ne(e),fe&&fe()}),[fe,Ne,G]),it=(0,i.useCallback)((()=>{const{pageName:e}=G;Ne(e),je({show:$e+1})}),[G,$e,Ne,je]),lt=(0,i.useMemo)((()=>pe.map((e=>{let{value:t,label:a}=e;return{value:t,label:we(a)}}))),[pe,we]),nt=(0,i.useRef)(),ot=(0,N.Z)({isSearching:le,cacheKey:"nintendo.plp.cache",cachePrefix:U,activeIndexName:me,rawSearchHits:oe}),ct=(0,i.useMemo)((()=>({value:Re.value,label:we(Re.label)})),[Re,we]),ut=(0,i.useMemo)((()=>Ue.map((e=>({attribute:e.split(x.HA)[0],label:e.split(x.HA)[1],value:e})))),[Ue]),pt=(0,i.useMemo)((()=>{const e=new Set;return qe.filter((t=>{if(!e.has(t.sku))return e.add(t.sku),!0}))}),[qe]),mt=(0,i.useMemo)((()=>(0,M.hG)(de,ut)),[de,ut]),dt=(0,i.useMemo)((()=>Ve.map(((e,t)=>{let{title:a,attribute:r}=e,i=(0,s.Z)(e,_);const l=ne?.[r]||[];return(0,C.jsx)(H,V({title:a&&we(a),attribute:r,startCollapsed:0!==t,showMoreLabel:we("Show more"),showLessLabel:we("Show less"),collapsible:!0,limit:5,showMore:!0,refine:et,cmsRefine:Xe,items:l,cmsItems:Ke[r]?.items||[],analytics:{pageName:G.pageName}},i),r)}))),[Ve,we,G,Ke,Xe,et,ne]),ht=(0,i.useMemo)((()=>!de?.length&&!ut?.length&&Re?.value===u.f.DEFAULT&&Ge?.length>0),[de,ut,Re,Ge]),ft=ht?Ge:pt,gt=X||ft.length,bt=(0,i.useMemo)((()=>ft.slice(0,gt*($e+1))),[$e,ft,gt]),jt=bt.length<ft.length,yt=Math.max(0,Math.ceil(ft.length/gt)-1),xt=Pe&&(!("number"===typeof X)&&!ht||$e>yt||!bt?.length||Re?.value!==u.f.DEFAULT),Pt=(0,i.useMemo)((()=>Pe?jt?(0,C.jsx)(z.VR,{children:(0,C.jsx)(h.B,{variant:"tertiary",icon:f.Z,onClick:it,children:we(Q)})}):xt?(0,C.jsx)(S.CD,{isLoading:le,hasMore:ce,onLoadMoreClick:st}):ot.length>0?(0,C.jsx)(z.VR,{children:(0,C.jsx)(h.B,{variant:"tertiary",icon:f.Z,onClick:it,children:we(Q)})}):null:null),[Pe,ot,le,ce,jt,xt,we,Q,st,it]),vt=(0,i.useMemo)((()=>ht?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(S.en,{ref:Ie,$singleColumnMobile:De,children:[bt.map(((e,t)=>e.sku?(0,C.jsx)(v.I8,V(V({featureFlag:Fe?.id,featureFlagVariant:Ce},e),{},{constrain:!1,showRating:D||Boolean(Se.query[k.Tx.UTM_CODE])||!1,mobileHorizontal:De,analytics:{listDetails:{id:`plp-${(0,O.GL)(G.pageName)}`,name:G.pageName}}}),`default-cms-${e.sku}-${t}`):(0,C.jsx)(F.Z,{cta:e.cta,heading:e.heading,asset:e.asset.primary.assetPath},e.heading+t))),xt&&ot.map((e=>{let{objectID:t}=e,a=(0,s.Z)(e,T);return(0,C.jsx)(S.xb,V(V({},a),{},{showRating:D||!1,mobileHorizontal:De,analytics:{eventName:Le,searchId:a.searchId,position:a.resultsPosition,locale:Se.locale,pageName:G?.pageName,itemListDetails:{id:`plp-${(0,O.GL)(G.pageName)}`,name:G.pageName}}}),`default-search-${t}`)}))]}),Pt]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(S.en,{ref:Ie,$singleColumnMobile:De,children:[bt.map(((e,t)=>(0,C.jsx)(v.I8,V(V({featureFlag:Fe?.id,featureFlagVariant:Ce},e),{},{constrain:!1,mobileHorizontal:De,analytics:{listDetails:{id:`plp-${(0,O.GL)(G.pageName)}`,name:G.pageName}}}),`filtered-cms-${e.sku}-${t}`))),xt&&ot.map((e=>{let{objectID:t}=e,a=(0,s.Z)(e,A);return(0,C.jsx)(S.xb,V(V({mobileHorizontal:De},a),{},{analytics:{eventName:Le,searchId:a.searchId,position:a.resultsPosition,locale:Se.locale,pageName:G.pageName,itemListDetails:{id:`plp-${(0,O.GL)(G.pageName)}`,name:G.pageName}}}),`filtered-search-${t}`)}))]}),Pt]})),[G.pageName,Le,ht,D,Ie,bt,ot,Se.locale,Se.query,Fe,Ce,De,xt,Pt]);(0,$.Z)({isDesktop:He,scrollToRef:nt,scrollToElementID:J,enableStickyCollectionNav:Y,pillFarm:te.list}),(0,i.useEffect)((()=>{Qe((0,n.uX)(Se.asPath))}),[Qe,Se.asPath]),(0,i.useEffect)((()=>{Ze.current&&nt.current&&(0,O.n5)(nt.current)}),[de.length,ut.length]);const Ot=()=>(0,C.jsx)(g.B,{currentPage:Se.pathname,children:L.map(((e,t)=>(0,C.jsx)(o.Z,{href:e.href,children:(0,C.jsx)("a",{children:we(e.title)})},e.title+t)))});return(0,C.jsxs)(B.Kq,{preview:t,disableScrollRestoration:!0,children:[se&&(0,C.jsx)(Oe,{children:(0,C.jsx)(ve,{marketingPage:se})}),(0,C.jsx)(S.JL,{children:L&&Ot()}),ee.asset?.primary?.assetPath&&(0,C.jsx)(C.Fragment,{children:K?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.F,{heading:ee.heading,subtitle:ee.description,image:{desktop:{assetPath:ee.asset?.primary?.assetPath},mobile:{assetPath:ee.asset?.secondary?.assetPath}},pillFarm:te.list,icon:r}),(0,C.jsx)(S.Hr,{})]}):(0,C.jsx)(S.tm,{iconName:r,content:{assetPath:ee.asset?.primary?.assetPath,assetPathAlt:ee.asset?.alt,background:ee.background,cta:ee.cta,description:ee.description,heading:ee.heading,modifiers:ee.modifiers}})}),(0,C.jsxs)(d.H.NewLevel,{children:[!K&&te?.list.length>0&&(0,C.jsx)(S.$0,{constrained:!0,small:!0,divider:["bottom"],children:(0,C.jsx)(S.l6,{center:!0,items:te.list})}),(0,C.jsx)("span",{ref:nt,id:"products","data-drawer-id":J}),(0,C.jsx)(j.S,{size:48,axis:"vertical"}),(0,C.jsxs)(S.He,{children:[(0,C.jsxs)(z.zB,{$breadcrumbs:!!L,children:[(0,C.jsx)(p.D,{children:L&&Ot()}),(0,C.jsx)(m.S,{label:we("Sort by"),onSelect:rt,options:lt,dropdownValue:Pe?ct:null}),(0,C.jsx)(p.M,{children:(0,C.jsx)(S.Lb,{icon:y.Z,variant:"tertiary",onClick:ze,children:we("Filter")})})]}),(0,C.jsx)(j.S,{size:32,axis:"vertical"}),(0,C.jsx)(S.dA,{enableStickyFilterPanel:!0,isFilterModalOpen:Be,toggleModalFiltersMenu:ze,attributeFilterSets:dt,isDesktop:He,stickyOffset:Y&&parseInt(Z.TH)+16,customizeFilters:{activeFilters:mt,removeFilter:tt,clearFilters:at,totalHits:he+pt.length},children:vt})]}),(0,C.jsx)(S.y4,{})]})]})}U.defaultProps={filterCMSProducts:!0,seeAllCtaLabel:"See all"};var q=U},61748:function(e,t,a){a.d(t,{Z:function(){return c}});var r=a(82269),s=a(2784),i=a(64897),l=a(19885),n=a(32899);const o=["p"];var c=e=>{const{0:t,1:a}=(0,s.useState)([]),{isSearching:c,cacheKey:u,cachePrefix:p,activeIndexName:m,rawSearchHits:d}=e,h=(0,i.Z)(),f=(0,n.i1)();return(0,s.useEffect)((()=>{const e=(0,n.uX)(h.asPath),{p:t}=e,s=(0,r.Z)(e,o),i=((e,t)=>{try{return JSON.parse(sessionStorage.getItem(e))||t}catch{return t}})(u,{}),g=`${p}_${JSON.stringify(s)}_${h.locale}`,b=c?i[g]||[]:((e,t)=>{const a=t?.[0]?.__position||0;return[...(e||[]).slice(0,a),...t]})(i[g],d);((e,t)=>{try{sessionStorage.setItem(e,JSON.stringify(t))}catch{return null}})(u,{[g]:b});const j=Object.values(b).sort(((e,t)=>e.__position-t.__position)),y=(0,l.p)(j,{locale:h.locale,localizer:f,indexName:m});a(y)}),[c,u,p,d,h.asPath,h.locale,m,f]),t}}}]);